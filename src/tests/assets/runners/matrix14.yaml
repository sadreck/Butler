name: Continuous Benchmarks (Receive)

concurrency:
  group: ${{ github.workflow }}-${{ github.head_ref }}
  cancel-in-progress: true

on:
  pull_request:
    branches:
      - '*'

jobs:
  build:
    needs: prepare
    runs-on: ${{ matrix.config.os }}
    strategy:
      fail-fast: false
      matrix:
        config:
          - ${{ fromJson(needs.prepare.outputs.config) }}
    env:
      R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
      RSPM: ${{ matrix.config.rspm }}
      GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}
    steps:
      - uses: lorenzwalthert/touchstone/actions/receive@v1
        with:
          cache-version: 1
          benchmarking_repo: ${{ matrix.config.benchmarking_repo }}
          benchmarking_ref: ${{ matrix.config.benchmarking_ref }}
          benchmarking_path: ${{ matrix.config.benchmarking_path }}
